---
phase: 03-immediate-fixes
plan: 01
type: execute
depends_on: []
files_modified: []
---

<objective>
Execute pending code review fixes and clean up old session files

Purpose: Resolve critical bugs and reduce disk usage from accumulated sessions
Output: Fixed code with passing tests, cleaned session directory
</objective>

<execution_context>
@.goodflows/workflows/execute-plan.md
@.goodflows/templates/summary.md
</execution_context>

<context>
@.goodflows/PROJECT.md
@.goodflows/ROADMAP.md
@.goodflows/STATE.md
@.goodflows/phases/01-fix-review-findings/01-01-PLAN.md
</context>

<tasks>

<task type="auto" id="task-1">
  <name>Execute Phase 01 Plan 01 fixes</name>
  <files>lib/gsd-executor.js, lib/git-service.js</files>
  <action>
    Execute the pending fixes from Phase 01:

    1. GOO-141: In lib/gsd-executor.js _runVerification (lines 407-435):
       - Add process.kill('SIGTERM') on timeout
       - Add SIGKILL fallback after 5 seconds
       - Clean up event listeners

    2. GOO-142: In lib/gsd-executor.js _executeTaskViaSubagent (lines 277-299):
       - Add _validateSubagentResult(result) helper
       - Validate required properties: success, files, output
       - Throw descriptive error on validation failure

    3. GOO-143: In lib/git-service.js stageFiles (lines 90-120):
       - Remove existsSync() check
       - Let git handle non-existent files
       - Catch and handle git errors gracefully
  </action>
  <verify>npm test</verify>
  <done>All 3 issues fixed, tests pass</done>
</task>

<task type="auto" id="task-2">
  <name>Clean up old session files</name>
  <files>.goodflows/context/sessions/</files>
  <action>
    Clean up accumulated session files:

    1. Archive sessions older than 7 days to .goodflows/archive/sessions/
    2. Keep only the 20 most recent sessions in active directory
    3. Create a cleanup script for future use

    DO NOT delete sessions from today (2026-01-16)
  </action>
  <verify>ls -la .goodflows/context/sessions/ | wc -l</verify>
  <done>Session count reduced from 57 to ~20, old sessions archived</done>
</task>

<task type="auto" id="task-3">
  <name>Update Linear issues status</name>
  <files>N/A</files>
  <action>
    Mark fixed issues as Done in Linear:
    - GOO-141: Process cleanup → Done
    - GOO-142: Subagent validation → Done
    - GOO-143: TOCTOU fix → Done

    Add resolution comments with commit hashes
  </action>
  <verify>Check Linear issue statuses</verify>
  <done>All 3 Linear issues marked as Done with resolution comments</done>
</task>

</tasks>

<verification>
Before declaring complete:
- [ ] npm test passes (all 385+ tests)
- [ ] npm run lint passes
- [ ] Session directory cleaned
- [ ] Linear issues updated
</verification>

<success_criteria>
- GOO-141, GOO-142, GOO-143 all fixed
- Tests pass
- Session files cleaned up
- Linear issues closed
</success_criteria>
